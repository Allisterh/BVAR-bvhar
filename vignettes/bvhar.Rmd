---
title: "Introduction to BVHAR"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to BVHAR}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  comment = "#>",
  collapse = TRUE,
  out.width = "70%",
  fig.align = "center",
  fig.width = 6,
  fig.asp = .618,
  fig.pos = "H"
  )
options(digits = 3)
```

```{r pkgs}
library(bvhar)
```

```{r addpkgs}
# for this vignette--------------
library(dplyr)
```

# Simple Setting

## ETF Dataset

```{r etfdat}
etf_vix
```

Gold, crude oil, euro currency, and china ETF.

```{r etfidx}
var_idx <- c("GVZCLS", "OVXCLS", "EVZCLS", "VXFXICLS")
```

Train and test: 19

```{r}
h <- 19
#-------------------
etf <- 
  etf_vix %>% 
  select(all_of(var_idx))
etf_train <- 
  etf %>% 
  slice(seq_len(n() - h))
#-------------------
etf_test <- setdiff(etf, etf_train)
#-------------------
m <- ncol(etf)
```

# VHAR

```{r}
fit_har <- vhar_lm(etf_train)
pred_har <- predict(fit_har, n.ahead = h)
mse_har <- apply(etf_test - pred_har, 2, function(x) mean(x^2))
```

# Minnesota Prior

```{r}
lam <- .5
delta <- rep(1, m)
sig <- apply(etf_train, 2, sd)
eps <- 1e-04
```

```{r}
(fit_bvhar <- bvhar_minnesota(etf_train, sig, lam, delta, eps))
```

## Forecasting

```{r}
(pred_bvhar <- predict(fit_bvhar, h))
```

MSE:

```{r}
(mse_bvhar <- apply(etf_test - pred_bvhar, 2, function(x) mean(x^2)))
```

Compare:

```{r}
# VHAR-------------
mean(mse_har)
# BVHAR------------
mean(mse_bvhar)
```




